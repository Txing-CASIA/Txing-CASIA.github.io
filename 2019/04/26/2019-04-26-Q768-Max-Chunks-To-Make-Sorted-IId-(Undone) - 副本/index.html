<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"txing-casia.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":240,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Max Chunks To Make Sorted II Question  *This question is the same as &quot;Max Chunks to Make Sorted&quot; except the integers of the given array are not necessarily distinct, the input array could be up">
<meta property="og:type" content="article">
<meta property="og:title" content="Q768 Max Chunks To Make Sorted II-(Hard)">
<meta property="og:url" content="https://txing-casia.github.io/2019/04/26/2019-04-26-Q768-Max-Chunks-To-Make-Sorted-IId-(Undone)%20-%20%E5%89%AF%E6%9C%AC/index.html">
<meta property="og:site_name" content="Txing">
<meta property="og:description" content="Max Chunks To Make Sorted II Question  *This question is the same as &quot;Max Chunks to Make Sorted&quot; except the integers of the given array are not necessarily distinct, the input array could be up">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-04-25T16:00:00.000Z">
<meta property="article:modified_time" content="2023-03-25T01:54:14.947Z">
<meta property="article:author" content="Txing">
<meta property="article:tag" content="Algorithm">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Array">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://txing-casia.github.io/2019/04/26/2019-04-26-Q768-Max-Chunks-To-Make-Sorted-IId-(Undone)%20-%20%E5%89%AF%E6%9C%AC/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Q768 Max Chunks To Make Sorted II-(Hard) | Txing</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Txing</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">欢迎来到 | 伽蓝之堂</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://txing-casia.github.io/2019/04/26/2019-04-26-Q768-Max-Chunks-To-Make-Sorted-IId-(Undone)%20-%20%E5%89%AF%E6%9C%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Txing">
      <meta itemprop="description" content="泛用类人决战型机器人博士">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Txing">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Q768 Max Chunks To Make Sorted II-(Hard)
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-04-26 00:00:00" itemprop="dateCreated datePublished" datetime="2019-04-26T00:00:00+08:00">2019-04-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-03-25 09:54:14" itemprop="dateModified" datetime="2023-03-25T09:54:14+08:00">2023-03-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="max-chunks-to-make-sorted-ii"><a target="_blank" rel="noopener" href="https://leetcode.com/problems/max-chunks-to-make-sorted-ii/">Max
Chunks To Make Sorted II</a></h1>
<h2 id="question">Question</h2>
<blockquote>
<p>*This question is the same as "Max Chunks to Make Sorted" except the
integers of the given array are not necessarily distinct, the input
array could be up to length 2000, and the elements could be up to
10**8.*</p>
<p>Given an array <code>arr</code> of integers (<strong>not necessarily
distinct</strong>), we split the array into some number of "chunks"
(partitions), and individually sort each chunk. After concatenating
them, the result equals the sorted array.</p>
<p>What is the most number of chunks we could have made?</p>
</blockquote>
<blockquote>
<p><strong>Example 1</strong>:</p>
<p>Input: arr = [5,4,3,2,1] Output: 1 Explanation: Splitting into two or
more chunks will not return the required result. For example, splitting
into [5, 4], [3, 2, 1] will result in [4, 5, 1, 2, 3], which isn't
sorted.</p>
</blockquote>
<blockquote>
<p><strong>Example 1</strong>:</p>
<p>Input: arr = [2,1,3,4,4] Output: 4 Explanation: We can split into two
chunks, such as [2, 1], [3, 4, 4]. However, splitting into [2, 1], [3],
[4], [4] is the highest number of chunks possible.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong></p>
<ul>
<li><code>arr</code> will have length in range
<code>[1, 2000]</code>.</li>
<li><code>arr[i]</code> will be an integer in range
<code>[0, 10**8]</code>.</li>
</ul>
</blockquote>
<hr>
<h3 id="approach-1-sliding-window">Approach 1: Sliding Window</h3>
<p><strong>Intuition</strong></p>
<p>Let's try to find the smallest left-most chunk.</p>
<p><strong>Algorithm</strong></p>
<p>Notice that if <span class="math inline">\(a_1, a_2, \dots,
a_m\)</span> is a chunk, and <span class="math inline">\(a_1, a_2,
\dots, a_n\)</span> is a chunk (<em>m</em>&lt;<em>n</em>), then <span class="math inline">\(a_{m+1}, a_{m+2}, \dots, a_n\)</span> is a chunk
too. This shows that a greedy approach produces the highest number of
chunks.</p>
<p>We know the array <code>arr</code> should end up like
<code>expect = sorted(arr)</code>. If the count of the first
<code>k</code> elements minus the count what those elements should be is
zero everywhere, then the first <code>k</code> elements form a valid
chunk. We repeatedly perform this process.</p>
<p>We can use a variable <code>nonzero</code> to count the number of
letters where the current count is non-zero.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">maxChunksToSorted</span>(<span class="params">self, arr</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        count = collections.defaultdict(<span class="built_in">int</span>) <span class="comment"># 声明一个默认整数字典类型</span></span><br><span class="line">        ans = nonzero = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(arr, <span class="built_in">sorted</span>(arr)):</span><br><span class="line">            count[x] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> count[x] == <span class="number">0</span>: nonzero -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> count[x] == <span class="number">1</span>: nonzero += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            count[y] -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> count[y] == -<span class="number">1</span>: nonzero += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> count[y] == <span class="number">0</span>: nonzero -= <span class="number">1</span></span><br><span class="line">			<span class="comment"># 如果 count[x]中出现过的键都在count[y]中出现过了，nonzero=0</span></span><br><span class="line">            <span class="comment"># 此时分块计数一次</span></span><br><span class="line">            <span class="keyword">if</span> nonzero == <span class="number">0</span>: ans += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    arr = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>]</span><br><span class="line">    answer=Solution()</span><br><span class="line">    results=answer.maxChunksToSorted(arr)</span><br><span class="line">    <span class="built_in">print</span>(results)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<ul>
<li>Time Complexity: <em>O</em>(<em>N</em>log<em>N</em>), where
<em>N</em> is the length of <code>arr</code></li>
<li>Space Complexity: <em>O</em>(<em>N</em>).</li>
</ul>
<hr>
<h3 id="approach-2-sorted-count-pairs">Approach 2: Sorted Count
Pairs</h3>
<p><strong>Intuition</strong></p>
<p>As in <em>Approach 1</em>, let's try to find the smallest left-most
chunk, where we have some expectation
<code>expect = sorted(arr)</code></p>
<p>If the elements were distinct, then it is enough to find the smallest
<code>k</code> with <code>max(arr[:k+1]) == expect[k]</code>, as this
must mean the elements of <code>arr[:k+1]</code> are some permutation of
<code>expect[:k+1]</code>.</p>
<p>Since the elements are not distinct, this fails; but we can amend the
cumulative multiplicity of each element to itself to make the elements
distinct.</p>
<p><strong>Algorithm</strong></p>
<p>Instead of elements <code>x</code>, have counted elements
<code>(x, count)</code> where <code>count</code> ranges from
<code>1</code> to the total number of <code>x</code> present in
<code>arr</code>.</p>
<p>Now <code>cur</code> will be the cumulative maximum of
<code>counted[:k+1]</code>, where we expect a result of
<code>Y = expect[k]</code>. We count the number of times they are
equal.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">maxChunksToSorted</span>(<span class="params">self, arr</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        count = collections.Counter()</span><br><span class="line">        counted = []</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> arr:</span><br><span class="line">            count[x] += <span class="number">1</span></span><br><span class="line">            counted.append((x, count[x]))</span><br><span class="line"></span><br><span class="line">        ans, cur = <span class="number">0</span>, <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> X, Y <span class="keyword">in</span> <span class="built_in">zip</span>(counted, <span class="built_in">sorted</span>(counted)):</span><br><span class="line">            cur = <span class="built_in">max</span>(cur, X)</span><br><span class="line">            <span class="keyword">if</span> cur == Y:</span><br><span class="line">                ans += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>
<ul>
<li>Time Complexity: <em>O</em>(<em>N</em>log<em>N</em>), where
<em>N</em> is the length of <code>arr</code></li>
<li>Space Complexity: <em>O</em>(<em>N</em>).</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Algorithm/" rel="tag"># Algorithm</a>
              <a href="/tags/Python/" rel="tag"># Python</a>
              <a href="/tags/Array/" rel="tag"># Array</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/04/25/2019-04-25-Q905-Sort-Array-By-Parity/" rel="prev" title="Q905 Sort Array By Parity">
      <i class="fa fa-chevron-left"></i> Q905 Sort Array By Parity
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/04/29/2019-04-29-Q985-Sum-of-Even-Numbers-After-Queries/" rel="next" title="Q985 Sum of Even Numbers After Queries">
      Q985 Sum of Even Numbers After Queries <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#max-chunks-to-make-sorted-ii"><span class="nav-number">1.</span> <span class="nav-text">Max
Chunks To Make Sorted II</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#question"><span class="nav-number">1.1.</span> <span class="nav-text">Question</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#approach-1-sliding-window"><span class="nav-number">1.1.1.</span> <span class="nav-text">Approach 1: Sliding Window</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#approach-2-sorted-count-pairs"><span class="nav-number">1.1.2.</span> <span class="nav-text">Approach 2: Sorted Count
Pairs</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Txing</p>
  <div class="site-description" itemprop="description">泛用类人决战型机器人博士</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">229</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">57</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/yourname" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/yourname" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Txing</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
