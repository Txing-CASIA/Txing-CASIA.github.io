---
layout:     post
title:      "Word多行公式的换行、对齐与编号"
subtitle:   ""
date:       2021-12-01
author:     "Txing"
header-img: "img/post-bg-py.jpg"
tags:
    - Word Tips
---

# Word多行公式的换行、对齐与编号

### 需求描述

使用Word进行公式编辑的过程中需要

- 需求1：单行公式的编号并调用；
  - 额外需求：编号修改；
- 需求2：多行公式的编辑与对齐；
- 需求3：多行公式，自定义某一行编号并调用；
- 需求4：长多公式的换行与对齐；

后面小节对这些问题进行拆解，并逐一提供解决办法。

---



### 解决方法

#### 需求1：单行公式的编号并调用

- Step 1：输入单行公式，在文档中单独成行并居中，鼠标停留于公式框最右端（图1）；

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-1.png)

- Step 2：公式框内最右端输入“#()”并按回车，获得如下效果（图2）；

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-2.png)

- Step 3：方框中需要编写公式序号，这里不直接书写，选中方框后按下 Ctrl + Fn + F9，在大括号中输入“seq equation”设置标签（图3），输入完成后按下 Fn + F9，自动获得序号；

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-3.png)

- Step 4：为了调用，需要在序号处设置书签。选中生成的序号（序号背景色变深灰），点击窗口栏的“插入 - 书签”根据个人习惯设置一个书签名（图4），之后点击确定；

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-4.png)

- Step 5：下面将在正文中对公式进行引用；引用位置如图5光标处所示。在窗口栏选择“插入 - 交叉引用”。“引用类型”选择“书签”，“引用内容”选择“书签文字”；“引用哪一个书签”选择在 Step 4 中定义的书签名（图6），单击“插入”。此时就完成了对公式的引用。

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-5.png)

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-6.png)



##### 额外需求：编号修改

- Extra Step 6：如果要对公式序号进行修改，这里假设要从“1”更改为“7”。光标移动到公式框中编号数字的左边（**注意必须是左边，右边不行！**）（图7）。输入需要的编号，这里输入“7”，然后单击Delete删除旧编号（图8）。

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-7.png)

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-8.png)

- Extra Step 7：此时正文中的公式编号仍然为“1”，需要框选中正文中的编号“1”，右键，点击“更新域”（图9），即可获得正确编号“7”。

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-9.png)

---



#### 需求2：多行公式的编辑与对齐

- Step 1：首先输入多行公式的第一行，光标移动到公式框右端位置，并且该位置恰好使得整行公式呈灰色（图10）。此时单击回车，可生成第二行的小方框（图11），在小方框中输入第二行公式（图12）。

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-10.png)

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-11.png)

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-12.png)

- Step 2：此时的两行公式都是居中，没实现在等号处对齐，只需在每行公式想要设置对齐点的位置输入“&”符号即可对齐（图13）（注意：输入“&”是不可见的，但会在输入位置出现短竖线位置标记）

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-13.png)

---



#### 需求3：多行公式，自定义某一行编号并调用

- Step 1：在已经完成了多行公式输入和对齐的情况下（图13），想要对某一个行进行编号。操作方法同需求1的Step 1和Step 2，但是Step 2中不是按回车，而是按空格（注意此时输入的“#“是不可见的）。之后的步骤继续参考需求1的解决办法即可（图14）。

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-13.png)

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-14.png)

---



#### 需求4：长多公式的换行与对齐；

- Step 1：遇到某行公式过于长，需要换行对齐的情况。首先输入长公式（图15）（可先输入一部分），在换行处回车（图16）；

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-15.png)

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-16.png)

- Step 2：在每一行想设置对齐点的位置输入“&”符号实现对齐，这里是在等号后和新行最前端设置“&”的（图17）；

![](https://raw.githubusercontent.com/txing-casia/txing-casia.github.io/master/img/20211201-17.png)



Ref：

[1]. Word 公式编号以及引用 https://www.bilibili.com/read/cv6527614/

[2]. word多行公式编号对齐 https://www.bilibili.com/read/cv6680157/



Pcon

2021年12月01日





























